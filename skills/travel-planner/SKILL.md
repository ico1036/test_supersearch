# Travel Planner Skill - 테마 기반 여행 일정 작성

## Metadata
- **Name**: travel-planner
- **Description**: 테마와 장소 기반으로 최적의 여행 코스를 설계하고, 검증된 식당/카페/활동을 5개 이상의 옵션으로 제공
- **Version**: 1.2.0
- **Use Cases**: "여행 계획", "여행 코스", "데이트 코스", "맛집 투어", "테마 여행", "단체 여행", "워크샵 일정"

---

## Core Purpose

사용자가 입력한 **장소 + 테마 + 세부 정보**를 기반으로:
1. 최적의 동선을 고려한 여행 코스 설계
2. 각 포인트별 5개 이상의 대안 제시 (식당, 카페, 활동)
3. 실시간 검증 (영업 상태, 위치, 시간, 수용 인원)
4. 대규모 그룹을 위한 "거리 기반" 분산 활동 설계
5. **시간대별 혼잡도 고려 + 숨은 로컬 맛집/카페 발굴**

---

## Input Parameters

사용자로부터 다음 정보를 수집:

| 파라미터 | 필수 | 설명 | 예시 |
|----------|------|------|------|
| `location` | ✅ | 여행 장소 (도시/지역) | "서울 성수동", "부산 해운대" |
| `theme` | ✅ | 여행 테마 | "힐링", "맛집 투어", "역사 탐방", "데이트", "팀빌딩" |
| `date` | ✅ | 여행 날짜 | "2025-02-15 토요일" |
| `time_range` | ✅ | 활동 시간대 | "10:00 - 20:00" |
| `group_size` | ✅ | 참여 인원 수 | "4명", "30명" |
| `budget` | ⬚ | 예산 범위 | "1인 5만원", "총 50만원" |
| `preferences` | ⬚ | 추가 선호사항 | "비건 옵션 필요", "주차 필수", "휠체어 접근성" |
| `exclusions` | ⬚ | 제외 조건 | "해산물 알러지", "술집 제외" |

---

## Validation Checklist (필수 검증 항목)

모든 추천 장소에 대해 다음 **5가지**를 반드시 확인:

### 1. 영업 상태 확인 (Is it Open?)
```
- [ ] 현재 영업 중인 업체인지 확인
- [ ] 폐업/휴업 여부 체크
- [ ] 최근 리뷰 날짜로 활성 상태 검증 (3개월 이내)
```

### 2. 위치 적절성 (Location Fit)
```
- [ ] 이전 장소에서 도보/차량 이동 시간 계산
- [ ] 동선 최적화 (지그재그 이동 방지)
- [ ] 주차 가능 여부 (차량 이동시)
- [ ] 해당 지역 내 위치인지 확인 (다른 지역 추천 금지)
```

### 3. 운영 시간 확인 (Operating Hours)
```
- [ ] 여행 당일 요일별 영업 시간 확인
- [ ] 브레이크 타임 체크
- [ ] 라스트 오더 시간 확인
- [ ] 아침 오픈 시간 확인 (아침 코스 필수 시)
```

### 4. 수용 인원 체크 (Capacity Check)
```
- [ ] 예상 방문 인원 수용 가능 여부
- [ ] 예약 필요 여부
- [ ] 대기 시간 예상 (피크 타임 여부)
```

### 5. 혼잡도 & 피크타임 체크 (NEW - Crowd Level)
```
- [ ] 해당 시간대 혼잡도 확인
- [ ] 주말/공휴일 웨이팅 예상
- [ ] 피크타임 회피 전략 제시
- [ ] 한산한 시간대 추천
```

---

## 추천 우선순위 원칙 (Recommendation Priority)

### ❌ 피해야 할 추천
1. **뻔한 관광지/시장** - 해당 지역 내 충분한 옵션이 있다면 굳이 이동 필요 없음
2. **일반 관광 정보 링크** - "XX 가볼만한곳" 같은 일반 포스트는 무의미
3. **접근 불가능한 링크** - 브런치, 개인 블로그 등 접근 제한 링크 제외
4. **너무 유명해서 항상 붐비는 곳** - 피크타임에 웨이팅 30분 이상 예상되면 대안 우선

### ✅ 우선 추천
1. **해당 지역 내 로컬 맛집** - 동네 주민이 자주 가는 곳
2. **숨은 맛집/카페** - 관광객보다 현지인 비율 높은 곳
3. **시간대별 최적 장소** - 아침엔 아침 전문점, 브런치엔 브런치 카페
4. **혼잡도 낮은 대안** - 같은 퀄리티인데 덜 붐비는 곳

---

## Execution Workflow

### Step 1: 입력 파싱 및 확인
사용자 요청에서 필수 파라미터 추출. 누락된 정보는 AskUserQuestion으로 수집.

**시간대 분석 필수:**
```
IF time_range includes morning (before 10:00):
  → 아침 식사 코스 필수 포함
  → 아침 오픈하는 맛집 별도 검색

IF time_range includes brunch (10:00-12:00):
  → 브런치 카페/맛집 검색
```

### Step 2: 병렬 웹 검색 (Parallel Search)

다음 검색을 동시 실행 (**시간대별 세분화**):

| 검색 대상 | 검색 쿼리 예시 |
|-----------|----------------|
| 아침 식사 | `"{location} 아침식사 맛집 오전 오픈"` |
| 점심 맛집 | `"{location} 점심 맛집 현지인 추천 웨이팅 없는"` |
| 카페 | `"{location} 카페 분위기 좋은 숨은 로컬"` |
| 저녁 맛집 | `"{location} 저녁 맛집 예약 가능"` |
| 숨은 맛집 | `"{location} 숨은 맛집 현지인 로컬 푸드"` |
| 혼잡도 | `"{location} {장소명} 웨이팅 대기시간 피크타임"` |

**검색 소스 우선순위 (접근 가능성 기준):**
```
1순위 (필수 접근 가능):
  - 다이닝코드 (diningcode.com) - 영업시간, 가격 정확
  - 식신 (siksinhot.com) - 현지인 맛집 정보
  - 네이버 플레이스 - 영업 정보 신뢰도 높음
  - 카카오맵 - 위치/영업 정보

2순위 (참고용):
  - 망고플레이트 - 맛집 전문
  - 트립어드바이저 - 리뷰 다양성

3순위 (주의 - 접근 제한 가능):
  ⚠️ 브런치 (brunch.co.kr) - 접근 제한 많음, 피하기
  ⚠️ 개인 블로그 - 링크 유효성 불확실
```

### Step 3: 검증 및 필터링

각 장소에 대해 Validation Checklist 5항목 확인:

```
For each place:
  1. WebSearch: "{장소명} 영업시간 {여행날짜 요일}"
  2. WebSearch: "{장소명} 예약 {인원수}명"
  3. WebSearch: "{장소명} 웨이팅 대기시간 {요일}"
  4. 위치 기반 동선 최적화 검토
  5. 접근 가능한 소스 링크 확보 (diningcode, siksinhot 우선)
```

### Step 4: 대규모 그룹 처리 (10명 이상)

```
IF group_size >= 10:
  - 단일 장소 대신 "거리/골목 상권" 중심 추천
  - 해당 거리 내 3-5개 분산 옵션 제시
  - 집결 포인트 및 분산 동선 설계
  - 각 서브그룹별 추천 장소 매핑
```

### Step 5: 결과 구성 및 파일 저장

검색 및 검증이 완료되면:
1. 결과를 마크다운 형식으로 구성
2. `results/` 디렉토리에 MD 파일로 저장
3. 파일명 규칙: `{location}-travel-plan-{YYYY-MM}.md`

---

## Output File Requirements (필수 출력 파일)

### 파일 저장 규칙
- **저장 위치**: `results/` 디렉토리
- **파일 형식**: Markdown (.md)
- **파일명 패턴**: `{location}-travel-plan-{YYYY-MM}.md`
- **인코딩**: UTF-8

---

## Output Structure (개선된 형식)

### 기본 형식

```markdown
# 🗺️ {theme} 여행 코스 - {location}

## 📋 여행 개요
| 항목 | 내용 |
|------|------|
| 날짜 | {date} |
| 시간 | {time_range} |
| 인원 | {group_size} |
| 테마 | {theme} |

---

## 🚶 추천 코스 (동선 최적화)

### ⏰ 08:00-10:00 | 아침 식사 ☀️
**🏆 메인 추천: {장소명}**
- 📍 주소: {주소}
- ⏰ 영업: {영업시간} | 아침 {X}시 오픈
- 👥 수용: {인원}
- 💰 가격: {가격대}
- 🚶 혼잡도: {한산/보통/혼잡} | 추천 시간: {X시}
- 💡 **추천 이유**: {왜 이 시간대에 이 장소인지 구체적 설명}
- 🔗 [다이닝코드](url) | [식신](url)

**📋 대안 옵션 (5개)**:
| # | 장소명 | 추천 이유 | 오픈시간 | 혼잡도 | 가격 | 소스 |
|---|--------|-----------|----------|--------|------|------|
| 1 | {name} | {이 시간대 추천 이유} | 07:00 | 한산 | ₩8,000 | [링크](url) |
| 2 | {name} | {이 시간대 추천 이유} | 08:00 | 보통 | ₩10,000 | [링크](url) |
...

---

### ⏰ 12:00-14:00 | 점심 식사 🍜
**🏆 메인 추천: {장소명}**
- 📍 주소: {주소}
- ⏰ 영업: {영업시간}
- 👥 수용: {인원}
- 💰 가격: {가격대}
- 🚶 혼잡도: 피크타임 12:30-13:30 웨이팅 {X}분 예상
- ⏱️ **피크 회피 전략**: {11:30 또는 14:00 이후 방문 권장}
- 💡 **추천 이유**: {숨은 맛집인 이유, 로컬 추천 이유 등}
- 🔗 [다이닝코드](url) | [식신](url)

---

### ⏰ 14:00-16:00 | 카페 타임 ☕
**🏆 메인 추천: {장소명}**
- 📍 주소: {주소}
- ⏰ 영업: {영업시간}
- 🪑 좌석: {좌석 수/분위기}
- 💰 가격: 아메리카노 {X}원
- 🚶 혼잡도: 오후 {X}시 이후 한산
- 💡 **추천 이유**: {왜 이 카페인지 - 분위기, 뷰, 숨은 곳 등}
- 🔗 [다이닝코드](url) | [식신](url)

---
```

---

## 추천 이유 작성 가이드 (WHY This Place)

각 장소마다 반드시 **추천 이유**를 명시:

### 좋은 예시 ✅
```
💡 추천 이유:
- 명주동 골목 안쪽에 위치해 관광객 적음
- 오전 11시 전 방문시 웨이팅 없음
- 적산가옥 개조 카페로 임장 테마에 적합
- 현지인 단골 비율 70% 이상
```

### 나쁜 예시 ❌
```
💡 추천 이유: 유명한 맛집입니다.
💡 추천 이유: 분위기가 좋습니다.
```

---

## Source Attribution Rules (개선됨)

### 필수 소스 첨부
- 모든 장소에 **접근 가능한** 소스 링크 필수
- 링크 클릭 시 실제 페이지 확인 가능해야 함

### 소스 우선순위 (접근 가능성 기준)
| 우선순위 | 소스 | 특징 |
|----------|------|------|
| 1 | 다이닝코드 | 영업시간, 가격 정확, 항상 접근 가능 |
| 2 | 식신 | 현지인 맛집, 항상 접근 가능 |
| 3 | 네이버 플레이스 | 영업 정보 신뢰 |
| 4 | 카카오맵 | 위치/영업 정보 |
| 5 | 망고플레이트 | 맛집 전문 |

### ⚠️ 피해야 할 소스
| 소스 | 이유 |
|------|------|
| 브런치 (brunch.co.kr) | 접근 제한 많음, 로그인 필요 |
| 개인 블로그 | 링크 만료/삭제 가능성 |
| 일반 관광 포스트 | "XX 가볼만한곳" 류 - 무의미 |

---

## Error Handling

| 상황 | 대응 |
|------|------|
| 영업 정보 미확인 | ⚠️ 표시 + "방문 전 전화 확인 권장" |
| 인원 수용 불확실 | 예약 필수 표시 + 대안 장소 우선 제시 |
| 검색 결과 부족 | 인근 지역 확장 검색 + 키워드 변형 |
| 모든 옵션 부적합 | 사용자에게 조건 완화 제안 |
| **접근 불가 링크 발견** | 해당 소스 제외, 대체 소스 검색 |
| **해당 지역 외 추천** | 해당 지역 내 옵션 재검색 |

---

## Final Output Checklist (최종 출력 체크리스트)

스킬 실행 완료 시 반드시 확인:

```
□ 시간대별 코스 완성 (아침 포함 여부 확인)
□ 모든 장소 5항목 검증 완료 (혼잡도 포함)
□ 각 시간대별 5개 이상 대안 옵션 제시
□ 모든 장소에 "추천 이유" 명시
□ 모든 소스 링크 접근 가능 확인 (브런치 등 제외)
□ 해당 지역 내 장소만 추천 (다른 지역 추천 금지)
□ 숨은 맛집/로컬 맛집 우선 배치
□ 피크타임 회피 전략 포함
□ 검증 요약 테이블 포함
□ results/ 디렉토리에 MD 파일 저장 완료 ← 필수!
```

---

## Version History

| 버전 | 날짜 | 변경 사항 |
|------|------|-----------|
| 1.0.0 | 2025-01 | 초기 버전 - 테마 여행 코스 생성 |
| 1.1.0 | 2025-01 | MD 파일 자동 저장 기능 추가 |
| 1.2.0 | 2025-01 | 혼잡도 체크 추가, 숨은 맛집 우선, 접근 가능 링크만 허용, 추천 이유 필수화, 아침 코스 필수 포함 |
